{% extends "base.html" %}

{% block title %}Sales Analytics - BookBazaar{% endblock %}

{% block content %}
<div class="seller-dashboard-container">
    <!-- Premium Glass Header -->
    <header class="seller-header-glass">
        <div class="seller-brand">
            <h1>Sales & Analytics</h1>
            <p>Track your revenue flow and orders performance.</p>
        </div>
        <div class="seller-status-box">
            <div class="seller-status-pill status-valid" style="background: linear-gradient(135deg, #eef2ff 0%, #e0e7ff 100%); color: #4338ca; border-color: #c7d2fe;">
                <span class="s-icon">üíº</span> Pro Merchant
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="p-nav">
        <a href="{{ url_for('seller.dashboard') }}" class="p-nav-btn">Inventory</a>
        <a href="{{ url_for('seller.sales') }}" class="p-nav-btn active">Sales & Analytics</a>
    </nav>

    <!-- Stats Row -->
    <div class="seller-stats-row">
        <div class="premium-stat-card stat-revenue">
            <div class="stat-icon-bg">üí∞</div>
            <div class="stat-info">
                <span class="stat-val">‚Çπ{{ "%.2f"|format(total_revenue) }}</span>
                <span class="stat-lbl">Gross Revenue</span>
            </div>
        </div>
        <div class="premium-stat-card">
            <div class="stat-icon-bg">üõçÔ∏è</div>
            <div class="stat-info">
                <span class="stat-val">{{ sales|length }}</span>
                <span class="stat-lbl">Total Orders</span>
            </div>
        </div>
        <div class="premium-stat-card">
            <div class="stat-icon-bg">üéØ</div>
            <div class="stat-info">
                <span class="stat-val">{% if sales|length > 0 %}{{ (total_revenue / sales|length)|round(2) }}{% else %}0{% endif %}</span>
                <span class="stat-lbl">Avg. Order Value</span>
            </div>
        </div>
    </div>

    <!-- Sales History -->
    <section class="premium-container">
        <h2 class="premium-title">üìú Transaction History</h2>
        <div style="overflow-x: auto;">
            <table class="p-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Book Details</th>
                        <th>Customer</th>
                        <th>Status</th>
                        <th style="text-align: right;">Total Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sale in sales %}
                    <tr class="p-row">
                        <td>
                            <code style="background: #f1f5f9; padding: 4px 8px; border-radius: 6px; font-weight: 700; color: #475569;">#{{ sale.id }}</code>
                        </td>
                        <td>
                            <div class="p-book-meta">
                                <div>
                                    <span class="bt-title">{{ sale.book.title }}</span>
                                    <span class="bt-author">Qty: {{ sale.quantity }}</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <span style="font-weight: 600; color: var(--text-medium);">{{ sale.user.username }}</span>
                        </td>
                        <td>
                            <span class="status-badge status-{{ sale.status.lower() }}" style="padding: 0.5rem 1rem; border-radius: 50px; font-size: 0.75rem;">
                                {{ sale.status }}
                            </span>
                        </td>
                        <td style="text-align: right;">
                            <span class="p-price" style="color: #059669;">‚Çπ{{ "%.2f"|format(sale.total_price) }}</span>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5">
                            <div class="empty-state">
                                <div class="empty-icon">üí∏</div>
                                <h3>No Sales Yet</h3>
                                <p>Keep optimizing your listings to attract more buyers.</p>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</div>
{% endblock %}
